<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lesson Market — Vue (Split Files)</title>

  <!-- Fonts / Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { poppins: ['Poppins', 'sans-serif'] },
          boxShadow: { glow: '0 10px 25px rgba(99,102,241,0.25)' },
        }
      }
    }
  </script>

  <!-- Vue 2 CDN -->
  <script src="https://unpkg.com/vue@2.7.8/dist/vue.js"></script>

  <style>
    [v-cloak]{display:none}
    .list-enter-active,.list-leave-active{transition:all .35s ease}
    .list-enter{opacity:0;transform:translateY(10px) scale(.98)}
    .list-leave-to{opacity:0;transform:translateY(-10px) scale(.98)}
    .fade-enter-active,.fade-leave-active{transition:opacity .3s ease}
    .fade-enter,.fade-leave-to{opacity:0}
  </style>
</head>
<body class="min-h-screen bg-slate-950 text-slate-100 font-poppins">

  <div id="app" v-cloak class="max-w-7xl mx-auto p-6">
    <!-- Header -->
    <header class="flex items-center justify-between gap-4 mb-6">
      <div class="flex items-center gap-3">
        <div class="w-11 h-11 rounded-2xl bg-gradient-to-tr from-indigo-500 via-fuchsia-500 to-cyan-400 flex items-center justify-center shadow-glow">
          <i class="fa-solid fa-graduation-cap text-white text-xl"></i>
        </div>
        <div>
          <h1 class="text-2xl md:text-3xl font-semibold">Lesson Market</h1>
          <p class="text-slate-400 text-sm -mt-0.5">Vue components split by feature ✨</p>
        </div>
      </div>

      <div class="flex items-center gap-3">
        <!-- Desktop Search -->
        <search-bar class="hidden md:block" v-model="search" :loading="searching"></search-bar>


        <!-- Sort Controls -->
        <sort-controls :sort-key.sync="sortKey" :sort-order.sync="sortOrder"></sort-controls>

        <!-- Cart / View Lessons toggle -->
        <button @click="toggleCart"
                :disabled="!showCart && cartCount===0"
                class="relative bg-gradient-to-r from-indigo-500 via-fuchsia-500 to-cyan-400
                       text-slate-900 font-semibold rounded-xl px-4 py-2 shadow-glow
                       hover:brightness-110 active:scale-95 disabled:opacity-40 disabled:cursor-not-allowed">
          <i class="fa-solid" :class="showCart ? 'fa-book-open' : 'fa-cart-shopping'"></i>
          <span class="ml-2">{{ showCart ? 'View Lessons' : 'Cart' }}</span>
          <span v-if="!showCart && cartCount"
                class="absolute -top-2 -right-2 bg-white text-slate-900 text-xs font-bold rounded-full w-6 h-6 grid place-items-center">{{ cartCount }}</span>
        </button>
      </div>
    </header>

    <!-- Mobile Search -->
    <div class="md:hidden mb-4">
      <search-bar v-model="search"></search-bar>
    </div>

    <transition name="fade" mode="out-in">
      <!-- LESSONS PAGE -->
      <section v-if="!showCart" key="lessons">
        <p v-if="!sortedLessons.length" class="mb-4 text-slate-300">
          No lessons found<span v-if="search"> for “{{ search }}”</span>.
        </p>

        <transition-group name="list" tag="div" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
          <lesson-card
            v-for="lesson in sortedLessons"
            :key="lesson.id"
            :lesson="lesson"
            @add="addToCart">
          </lesson-card>
        </transition-group>
      </section>

      <!-- CART + CHECKOUT PAGE -->
      <section v-else key="cart" class="grid lg:grid-cols-3 gap-6">
        <cart-list
          class="lg:col-span-2"
          :cart="cart"
          :spaces-map="spacesMap"
          @increment="increment"
          @decrement="decrement"
          @remove="removeById">
        </cart-list>

        <checkout-box
          :name.sync="name"
          :phone.sync="phone"
          :has-items="cart.length>0"
          :submitted="submitted"
          :total="cartTotal"
          @checkout="checkout">
        </checkout-box>
      </section>
    </transition>

    <footer class="mt-10 text-center text-slate-500 text-xs">
      Built with ❤️ Vue 2 + Tailwind • Split into reusable components
    </footer>
  </div>

  <!-- Data, Components, App -->
  <script src="js/components/SearchBar.js"></script>
  <script src="js/components/SortControls.js"></script>
  <script src="js/components/LessonCard.js"></script>
  <script src="js/components/CartList.js"></script>
  <script src="js/components/CheckoutBox.js"></script>
  <script src="js/app.js"></script>
</body>
</html>
